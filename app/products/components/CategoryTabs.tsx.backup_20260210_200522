"use client";

import { useState, useEffect } from 'react';

interface CategoryTabsProps {
  activeCategory: string;
  onCategoryChange: (category: string) => void;
}

interface Category {
  id: string;
  name: string;
}

export default function CategoryTabs({ activeCategory, onCategoryChange }: CategoryTabsProps) {
  const [categories, setCategories] = useState<Category[]>([]);

  useEffect(() => {
    // Load categories from localStorage
    const loadCategories = () => {
      const storedCategories = JSON.parse(localStorage.getItem('categories') || '[]');
      setCategories(storedCategories);
    };

    loadCategories();

    // Listen for category updates from admin panel
    window.addEventListener('categoriesUpdated', loadCategories);

    return () => {
      window.removeEventListener('categoriesUpdated', loadCategories);
    };
  }, []);

  const allCategories = [
    { id: 'all', name: 'All Products' },
    ...categories,
  ];

  return (
    <div className="flex flex-wrap items-center gap-4 mb-8">
      {allCategories.map((category) => (
        <button
          key={category.id}
          onClick={() => onCategoryChange(category.id === 'all' ? 'all' : category.name.toLowerCase())}
          className={`px-6 py-2 text-sm font-medium uppercase tracking-wide rounded-lg transition-all duration-300 ${
            activeCategory === (category.id === 'all' ? 'all' : category.name.toLowerCase())
              ? 'bg-primary text-primary-foreground shadow-md' :'text-muted-foreground hover:text-foreground hover:bg-secondary'
          }`}
        >
          {category.name}
        </button>
      ))}
    </div>
  );
}